<Window
        x:Class="Subscription_Manager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Subscription_Manager"
       xmlns:converters="clr-namespace:Subscription_Manager.Converters"
       

        Title="SubTrack"
        Height="450"
        Width="800"
        Background="#FFD9D9D9">
    <Window.InputBindings>
        
            <KeyBinding
            Key="N"
            Modifiers="Control"
            Command="{Binding NewSubscriptionCommand}"/>

            <KeyBinding
            Key="Escape"
            Command="{Binding ClearSearchCommand}"/>
        </Window.InputBindings>


        <Window.Resources>
        <converters:StringToBrushConverter x:Key="StringToBrushConverter"/>

        <DataTemplate x:Key="SubscriptionRowTemplate">
                <Border
                    x:Name="RowRoot"
                    BorderThickness="6,0,0,0"
                    BorderBrush="{Binding AccentBrush}"
                    CornerRadius="4"
                    Padding="8"
                    Margin="0,0,0,4">

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="110"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel>
                            <TextBlock Text="{Binding Name}" FontWeight="Bold"/>

                            <TextBlock
                                Text="{Binding BillingCycle}"
                                FontSize="12"
                                Foreground="#777"/>

                        <TextBlock
                            Text="{Binding Category}"
                            FontSize="11"
                            FontStyle="Italic"
                            Foreground="Gray"
                            Opacity="0.8">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Visible"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Category}" Value="">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Category}" Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>


                    </StackPanel>

                        <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                        <TextBlock
                            FontWeight="Bold"
                            HorizontalAlignment="Right">

                            <TextBlock.Text>
                                <MultiBinding StringFormat="{}{0}{1:F2}">
                                    <Binding Path="DataContext.AppSettings.CurrencySymbol"
                     RelativeSource="{RelativeSource AncestorType=Window}" />
                                    <Binding Path="Cost"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>


                        <TextBlock
                                Text="{Binding DaysUntilBillingText}"
                                FontSize="11"
                                Foreground="{Binding BillingWarningBrush}"
                                HorizontalAlignment="Right"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <DataTemplate.Triggers>
                    <DataTrigger Binding="{Binding IsActive}" Value="False">
                        <Setter TargetName="RowRoot" Property="Opacity" Value="0.55"/>
                    </DataTrigger>
                </DataTemplate.Triggers>
            </DataTemplate>
        </Window.Resources>

        <Grid PreviewMouseDown="RootGrid_PreviewMouseDown">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="220"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- LEFT PANEL -->
            <Border Grid.Column="0" Background="#FFF15A21">
                <StackPanel Margin="16">
                    <TextBlock
                        Text="SubTrack"
                        FontSize="24"
                        FontWeight="Bold"
                        Foreground="White"
                        Margin="0,0,0,24"/>

                    <StackPanel Visibility="{Binding CalculatorVisibility}">
                        <TextBlock Text="{Binding TotalLabel}" Foreground="White" FontWeight="Bold"/>

                    <TextBlock
                        FontSize="22"
                        FontWeight="Bold"
                        Foreground="White"
                        Margin="0,4,0,8"
                        FontFamily="Consolas">

                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0}{1:F2}">
                                <Binding Path="AppSettings.CurrencySymbol"/>
                                <Binding Path="DisplayedTotal"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>


                    <StackPanel Orientation="Horizontal">
                            <RadioButton
                                Content="Monthly"
                                IsChecked="True"
                                Checked="Monthly_Checked"
                                Foreground="White"/>

                            <RadioButton
                                Content="Yearly"
                                Margin="12,0,0,0"
                                Checked="Yearly_Checked"
                                Foreground="White"/>
                        </StackPanel>
                    </StackPanel>

                    <TextBlock
                        Margin="0,16,0,0"
                        Foreground="White"
                        TextAlignment="Center"
                        Text="{Binding SubscriptionCountText}"/>

                    <Button
                        Content="Active Subscriptions"
                        Margin="0,10,0,0"
                        Click="ShowActive_Click"
                        FontFamily="Cooper Black" Height="24"/>

                    <Button
                        Content="Disabled Subscriptions"
                        Margin="0,6,0,0"
                        Click="ShowDisabled_Click"
                        FontFamily="Cooper Black" Height="27"/>
                </StackPanel>
            </Border>

            <!-- RIGHT PANEL -->
            <Grid Grid.Column="1" Margin="24">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Header -->
<Grid Grid.Row="0" Margin="0,0,0,8">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
    </Grid.ColumnDefinitions>

    <!-- Title -->
    <TextBlock Grid.Column="0"
               Text="{Binding SubscriptionsHeader}"
               FontSize="22"
               FontWeight="Bold"
               FontFamily="Cooper Black"
               VerticalAlignment="Center"/>

    <!-- Actions -->
    <StackPanel Grid.Column="1"
                Orientation="Horizontal"
                VerticalAlignment="Center">

        <!-- Settings -->
        <Button Width="32"
                Height="32"
                Margin="0,0,8,0"
                ToolTip="Settings"
                Click="OpenSettings_Click"
                BorderBrush="#B0B0B0" FontFamily="Cooper Black" FontSize="16" Foreground="White" Background="#FF707070">
            <TextBlock Text="⚙"
                       FontSize="14"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Center" Foreground="White"/>
        </Button>

        <!-- Add -->
        <Button Width="80"
                Height="32"
                Content="Add"
                Click="Add_Click"
                FontFamily="Cooper Black"
                FontSize="16"
                Background="#FFF15A21"
                Foreground="White"/>
    </StackPanel>
</Grid>


                <StackPanel Grid.Row="1" Margin="0,10,0,0">

                    <!-- SEARCH (TextBox + Watermark Overlay) -->
                    <Grid Margin="0,10,0,0">
                        <TextBox
                            x:Name="SearchBox"
                            Height="30"
                            Padding="10,6"
                            FontSize="13"
                            Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                            ToolTip="Search by name or description"
                            SpellCheck.IsEnabled="False"/>




                        <!-- Watermark -->
                    <TextBlock
                            Text="Search subscriptions..."
                            Margin="12,0,0,0"
                            VerticalAlignment="Center"
                            Foreground="#777"
                            Opacity="0.65"
                            IsHitTestVisible="False">

                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger
                                            Binding="{Binding SearchText}"
                                            Value="">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>


                <ComboBox
                    x:Name="SortCombo"
                    Margin="0,6,0,0"
                    Height="26"
                    Width="254"
                    SelectedIndex="{Binding CurrentSortIndex, Mode=TwoWay}">

                    <ComboBoxItem Content="Sort by Name"/>
                    <ComboBoxItem Content="Sort by Cost (High → Low)"/>
                    <ComboBoxItem Content="Sort by Days Until Billing"/>
                </ComboBox>


            </StackPanel>

                <!-- List -->
                <Border
                    Grid.Row="2"
                    Margin="0,16,0,0"
                    BorderBrush="#CCC"
                    BorderThickness="1"
                    CornerRadius="6">

                    <Grid>
                        <ListView
                            ItemsSource="{Binding CurrentSubscriptions}"
                            ItemTemplate="{StaticResource SubscriptionRowTemplate}"
                            HorizontalContentAlignment="Stretch"
                            MouseDoubleClick="Subscriptions_DoubleClick">

                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="Cursor" Value="Hand"/>
                                    <Setter Property="Background" Value="Transparent"/>
                                </Style>
                            </ListView.ItemContainerStyle>
                        </ListView>


                        <TextBlock
                            Text="{Binding EmptyMessage}"
                            Visibility="{Binding EmptyMessageVisibility}"
                            Foreground="Gray"
                            FontStyle="Italic"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"/>
                    </Grid>
                </Border>
            </Grid>

            <!-- Footer -->
            <TextBlock
                Grid.Row="1"
                Grid.ColumnSpan="2"
                Text="{Binding AppVersion}"
                FontSize="10"
                Opacity="0.5"
                HorizontalAlignment="Center"
                Margin="0,4"/>
        </Grid>
    </Window>